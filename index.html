<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- URL íŒŒë¼ë¯¸í„° skipIntro=trueë©´ ì¸íŠ¸ë¡œ ìŠ¤í‚µ -->
  <script>
    (function () {
      try {
        const params = new URLSearchParams(window.location.search);
        if (params.get('skipIntro') === 'true') {
          document.documentElement.classList.add('skip-intro');
        }
      } catch (e) {}
    })();
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Planets of Faith</title>
  <link href="https://fonts.cdnfonts.com/css/farm-wave-free" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang&family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">

  <style>
    /* ===== ê¸°ë³¸ ===== */
    body {
      margin: 0;
      background: #2a231f;
      height: 10000vh;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    body::-webkit-scrollbar { display: none; }

    .no-select {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    /* ===== ì¸íŠ¸ë¡œ ì˜¤ë²„ë ˆì´ ===== */
    .intro-overlay {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 1s ease;
      pointer-events: none;
    }

    .intro-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      transform: translateY(-8vh);
    }

    .intro-title {
      font-family: 'Farm Wave Free', sans-serif;
      font-size: 2.5rem;
      color: #F4E4DC;
      letter-spacing: 0.05em;
      text-shadow: 0 0 12px rgba(0,0,0,0.6);
      opacity: 1;
      transition: opacity 1s ease;
      pointer-events: none;
      text-align: center;
    }
    .intro-title.hide { opacity: 0; }

    .intro-text {
      font-family: "Gowun Batang", serif;
      color: #F4E4DC;
      max-width: 80vw;
      font-size: 1rem;
      text-align: center;
      line-height: 1.7;
      letter-spacing: 0.04em;
      opacity: 0;
      transition: opacity 0.6s ease;
    }

    /* ===== ìƒë‹¨ ì•ˆë‚´ í…ìŠ¤íŠ¸ ===== */
    .title {
      font-family: "Gowun Batang", serif;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: #F4E4DC;
      font-size: 1rem;
      text-shadow: 0 0 8px rgba(0,0,0,0.6);
      z-index: 20;
      opacity: 0;
      transition: opacity 1s ease;
    }

    /* í˜„ì¬ ìºë¦­í„° ì•„ë˜ í–‰ì„± ì´ë¦„ */
    .planet-label {
      position: fixed;
      top: 52px;
      left: 50%;
      transform: translateX(-50%) translateY(6px);
      font-family: 'Farm Wave Free', sans-serif;
      font-size: 2rem;
      letter-spacing: 0.07em;
      color: #F4E4DC;
      text-shadow: 0 0 14px rgba(0,0,0,0.55);
      z-index: 20;
      opacity: 0;
      transition:
        opacity 0.55s ease,
        transform 0.6s ease;
    }
    .planet-label.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* ===== ë°°ê²½ ìš°ì£¼ ===== */
    .bg-layer {
      position: fixed;
      top: 50%;
      left: 50%;
      width: 220vmax;
      height: 220vmax;
      background: url("backgroundspace.jpg") center/cover no-repeat;
      z-index: -2;
      pointer-events: none;
      transform-origin: 50% 60%;
      transform: translate(-50%, -50%) rotate(0deg);
    }

    /* ===== í–‰ì„± ===== */
    .planet {
      position: fixed;
      left: 50%;
      bottom: 0;
      transform: translate(-50%, 160vw);
      width: 180vw;
      height: 180vw;
      z-index: 5;
    }

    .planet::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url("planet.png") center top / cover no-repeat;
      transform-origin: 50% 50%;
      transform: rotate(var(--planet-angle, 0deg));
    }

    /* ===== ê¶¤ë„ ë ˆì´ì–´ + ë³„ ===== */
    .orbit-layer {
      position: absolute;
      inset: 0;
      transform-origin: 50% 50%;
      transform: rotate(var(--orbit-angle, 0deg));
      z-index: 15;
      opacity: 0;
      pointer-events: none;
      transition: opacity 1s ease;
    }

    /* ê¶¤ë„ ì ì„  */
    

    /* ê¶¤ë„ìƒì˜ ë³„ */
    .orbit-dot {
      position: absolute;
      top: 50%;
      left: 50%;
      transform-origin: 50% 50%;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      pointer-events: auto;
      z-index: 15;
    }

    .orbit-dot:nth-child(2) {
      transform: translate(-50%, -50%) rotate(-125deg) translateY(-114vw);
    }
    .orbit-dot:nth-child(3) {
      transform: translate(-50%, -50%) rotate(-100deg) translateY(-114vw);
    }
    .orbit-dot:nth-child(4) {
      transform: translate(-50%, -50%) rotate(-75deg) translateY(-114vw);
    }
    .orbit-dot:nth-child(5) {
      transform: translate(-50%, -50%) rotate(-50deg) translateY(-114vw);
    }
    .orbit-dot:nth-child(6) {
      transform: translate(-50%, -50%) rotate(-25deg) translateY(-114vw);
    }
    .orbit-dot:nth-child(7) {
      transform: translate(-50%, -50%) rotate(0deg) translateY(-114vw);
    }

    .orbit-dot::before,
    .orbit-dot::after {
      pointer-events: none;
    }

    /* â­ ê¸°ë³¸ ë³„(ì½”ì–´) */
    .orbit-dot::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: white;
      transform: translate(-50%, -50%);
      box-shadow:
        0 0 4px rgba(255,255,255,0.8),
        0 0 12px rgba(255,255,255,0.9),
        0 0 22px rgba(255,255,255,0.8);
      animation: twinkle 2.4s ease-in-out infinite alternate;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    /* â­ í›„ê´‘ ë§ */
    .orbit-dot::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.35);
      background: radial-gradient(circle,
        rgba(255,255,255,0.18) 0,
        rgba(255,255,255,0.06) 45%,
        transparent 70%
      );
      box-shadow: 0 0 14px rgba(255,255,255,0.35);
      opacity: 0.7;
      animation: orbitPulse 2.6s ease-in-out infinite;
    }

    .orbit-dot:hover::after {
      transform: translate(-50%, -50%) scale(1.5);
      animation: none;
      box-shadow:
        0 0 6px rgba(255,255,255,1),
        0 0 20px rgba(255,255,255,1),
        0 0 32px rgba(255,255,255,1);
    }

    .orbit-dot:hover::before {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.05);
    }

    @keyframes twinkle {
      0%   { opacity: 0.4; box-shadow: 0 0 4px rgba(255,255,255,0.5); }
      50%  { opacity: 1;   box-shadow: 0 0 14px rgba(255,255,255,1); }
      100% { opacity: 0.6; box-shadow: 0 0 8px rgba(255,255,255,0.8); }
    }

    @keyframes orbitPulse {
      0%   { transform: translate(-50%, -50%) scale(1);    opacity: 0.5; }
      50%  { transform: translate(-50%, -50%) scale(1.12); opacity: 0.9; }
      100% { transform: translate(-50%, -50%) scale(1);    opacity: 0.5; }
    }

    /* LIFE ë³„ ê°•ì¡°(ì ê¸ˆ/í•´ì œëŠ” JSì—ì„œ ì²˜ë¦¬) */
    .orbit-dot--life::after {
      width: 22px;
      height: 22px;
      background: #fffbe8;
      box-shadow:
        0 0 6px rgba(255, 252, 230, 0.9),
        0 0 16px rgba(255, 255, 255, 0.95),
        0 0 32px rgba(255, 245, 210, 0.9);
      animation: lifeTwinkle 1.8s ease-in-out infinite alternate;
    }

    .orbit-dot--life::before {
      width: 120%;
      height: 120%;
      border: 1.5px solid rgba(255, 244, 220, 0.8);
      box-shadow:
        0 0 10px rgba(255, 244, 220, 0.7),
        0 0 22px rgba(255, 240, 210, 0.7);
      opacity: 0.9;
      animation: lifePulse 2.2s ease-in-out infinite;
    }

    .orbit-dot--life:hover::after {
      transform: translate(-50%, -50%) scale(1.7);
      box-shadow:
        0 0 8px rgba(255, 255, 255, 1),
        0 0 26px rgba(255, 255, 255, 1),
        0 0 40px rgba(255, 245, 220, 1);
    }

    .orbit-dot--life:hover::before {
      transform: translate(-50%, -50%) scale(1.12);
      opacity: 1;
    }

    @keyframes lifeTwinkle {
      0% {
        opacity: 0.7;
        transform: translate(-50%, -50%) scale(1.0);
      }
      50% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.08);
      }
      100% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(1.02);
      }
    }

    @keyframes lifePulse {
      0% {
        transform: translate(-50%, -50%) scale(1.0);
        opacity: 0.7;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.18);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1.0);
        opacity: 0.7;
      }
    }

    /* ===== íˆ´íŒ ===== */
    .tooltip {
      position: fixed;
      padding: 8px 12px;
      background: #F4E4DC;
      color: #2a231f;
      border-radius: 8px;
      font-family: "Gowun Batang", serif;
      font-size: 0.8rem;
      box-shadow: 0 4px 16px rgba(0,0,0,0.25);
      pointer-events: none;
      opacity: 0;
      visibility: hidden;
      transform: translate(-15%, -50%);
      transition: opacity 0.15s ease;
      z-index: 100000;
    }

    .tooltip-title {
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .lock-icon {
      width: 1em;
      height: 1em;
      display: none;
      object-fit: contain;
    }

    .locked-msg {
      font-weight: 400;
      font-size: 0.9em;
      opacity: 0.8;
      display: none;
    }

    .tooltip-desc {
      line-height: 1.4;
      white-space: nowrap;
    }

    /* ===== ê±·ëŠ” ìºë¦­í„° ===== */
    .walker {
      position: fixed;
      left: 50%;
      bottom: 8vh;
      transform: translateX(-50%);
      width: 800px;
      height: 800px;
      background-image: url("walkani.png");
      background-repeat: no-repeat;
      background-position: 0 0;
      transform-origin: 50% 100%;
      opacity: 0;
      transition: opacity 1s ease;
      z-index: 10;
      pointer-events: none;
    }

    /* ğŸ”¶ ê³µí†µ í–‰ì„± íƒí—˜ì™„ë£Œ ë±ƒì§€ + êº¾ì¸ ì ì„  */
    .planet-badge {
      position: fixed;
      z-index: 50;
      display: none;
      align-items: center;
      gap: 6px;
      pointer-events: none;
      font-family: "Gowun Batang", serif;
    }

    .planet-badge-circle {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: #F4E4DC;
      color: #3a2e28;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      box-shadow: 0 0 8px rgba(60, 45, 35, 0.45);
    }

    .planet-badge-text {
      color: #F4E4DC;
      font-size: 0.8rem;
      white-space: nowrap;
    }

    .planet-connector {
      position: fixed;
      z-index: 49;
      pointer-events: none;
    }

    .planet-connector-line {
      position: absolute;
      border-top: 1px dashed rgba(244, 228, 220, 0.9);
    }

    .planet-connector-diag {
      width: 26px;
      top: -2px;
      left: 6px;
      transform-origin: left center;
      transform: rotate(-35deg);
    }

    .planet-connector-horiz {
      width: 22px;
      top: -18px;
      left: 28px;
    }
/* ========================
   ğŸŒ™ ê°ˆìƒ‰ í˜ì´ë“œ ë¡œë”© í™”ë©´
======================== */
#loading-screen {
  position: fixed;
  inset: 0;
  background: #1f1916;  /* ì•„ì£¼ ì–´ë‘ìš´ ê°ˆìƒ‰ */
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 999999;
  opacity: 1;
  transition: opacity 1s ease; /* í˜ì´ë“œ ì•„ì›ƒ */
  pointer-events: all;
}

/* ë¡œë”© ì í”„í•˜ëŠ” ì› */
.loading-circle {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  background: #F4E4DC; /* í–‰ì„±/í…ìŠ¤íŠ¸ì™€ ë§ëŠ” ë² ì´ì§€ */
  margin-bottom: 14px;
  animation: loadingBounce 0.8s ease-in-out infinite alternate;
  box-shadow: 0 0 10px rgba(244,228,220,0.6);
}

/* Loadingâ€¦ í…ìŠ¤íŠ¸ */
.loading-text {
  color: #F4E4DC;
  font-family: "Gowun Batang", serif;
  font-size: 1rem;
  letter-spacing: 0.06em;
  opacity: 0;
  animation: fadeInText 1.5s ease forwards;
}

@keyframes loadingBounce {
  0% { transform: translateY(0) scale(1); }
  100% { transform: translateY(-10px) scale(1.15); }
}

@keyframes fadeInText {
  0% { opacity: 0; transform: translateY(4px); }
  100% { opacity: 1; transform: translateY(0); }
}

    /* ===== ì „ì²´ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° ===== */
    html {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    html::-webkit-scrollbar { display: none; }

    /* skipIntro ì¼ ë•Œ ì¸íŠ¸ë¡œ ì œê±° */
    html.skip-intro body { overflow: auto; }
    html.skip-intro .intro-overlay { display: none !important; }
    html.skip-intro .intro-title,
    html.skip-intro .intro-text { display: none !important; }
    html.skip-intro .title { opacity: 1 !important; }
    html.skip-intro .walker { opacity: 1 !important; }
    html.skip-intro .orbit-layer { opacity: 1 !important; }
  </style>
</head>
<body>
  <div id="page-transition"></div>
  <!-- ì¸íŠ¸ë¡œ í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ -->
  <div class="intro-overlay">
    <div class="intro-group no-select">
      <div class="intro-title no-select">Planets of Faith</div>
      <div class="intro-text no-select"></div>
    </div>
  </div>

  <!-- ë°°ê²½ ìš°ì£¼ -->
  <div class="bg-layer"></div>

  <!-- í–‰ì„± + ê¶¤ë„ë³„ -->
  <div class="planet">
    <div class="orbit-layer">
      <!-- ê¶¤ë„ ì ì„  -->
      <div class="orbit-arc">
        <svg viewBox="0 0 100 100" preserveAspectRatio="none">
          <path d="M 20 40 Q 50 10 80 40"
                stroke="white"
                stroke-width="1.5"
                stroke-dasharray="4 6"
                fill="none"
                stroke-linecap="round" />
        </svg>
      </div>

      <!-- ì—¬ì„¯ ê°œì˜ ë³„ -->
      <div class="orbit-dot orbit-dot--life"
           data-title="The Planet of Faith"
           data-desc="ë‹¹ì‹ ì´ ë¯¿ê³  ì‚´ì•„ê°€ëŠ” ê°€ì¹˜ê°€ ëª¨ì—¬ìˆëŠ” í–‰ì„±ì…ë‹ˆë‹¤."></div>
      <div class="orbit-dot"
           data-title="The Planet of Art"
           data-desc="ì´ ê³³ì˜ ê³¤ì¬ë“¤ì€ íŠ¹ì •í•œ ì˜ˆìˆ ê´€ì„ ê°€ì§€ê³  ì‚´ì•„ê°‘ë‹ˆë‹¤."></div>
      <div class="orbit-dot"
           data-title="The Planet of Ego"
           data-desc="ì´ ê³³ì˜ ê³¤ì¬ë“¤ì€ íŠ¹ì •í•œ ìì•„ê´€ì„ ê°€ì§€ê³  ì‚´ì•„ê°‘ë‹ˆë‹¤."></div>
      <div class="orbit-dot"
           data-title="The Planet of Emotion"
           data-desc="ì´ ê³³ì˜ ê³¤ì¬ë“¤ì€ íŠ¹ì •í•œ ê°ì •ê´€ì„ ê°€ì§€ê³  ì‚´ì•„ê°‘ë‹ˆë‹¤."></div>
      <div class="orbit-dot"
           data-title="The Planet of Work"
           data-desc="ì´ ê³³ì˜ ê³¤ì¬ë“¤ì€ íŠ¹ì •í•œ ì§ì—…ê´€ì„ ê°€ì§€ê³  ì‚´ì•„ê°‘ë‹ˆë‹¤."></div>
      <div class="orbit-dot"
           data-title="The Planet of Relation"
           data-desc="ì´ ê³³ì˜ ê³¤ì¬ë“¤ì€ íŠ¹ì •í•œ ê´€ê³„ê´€ì„ ê°€ì§€ê³  ì‚´ì•„ê°‘ë‹ˆë‹¤."></div>
    </div>
  </div>

  <!-- ìƒë‹¨ í…ìŠ¤íŠ¸ + í˜„ì¬ í–‰ì„± ë¼ë²¨ -->
  <div class="title no-select">íƒì‚¬í•  í–‰ì„±ì„ ì„ íƒí•˜ì„¸ìš”</div>
  <div class="planet-label no-select"></div>

  <!-- ê±·ëŠ” ìºë¦­í„° -->
  <div class="walker"></div>

  <!-- íˆ´íŒ -->
  <div class="tooltip" id="planetTooltip">
    <div class="tooltip-title">
      <span class="tooltip-title-text"></span>
      <img src="lock.png" alt="locked" class="lock-icon" />
      <span class="locked-msg">*5ê°œì˜ í–‰ì„± íƒí—˜ ì™„ë£Œ í›„ ì ê¸ˆì´ í•´ì œë©ë‹ˆë‹¤.*</span>
    </div>
    <div class="tooltip-desc"></div>
  </div>

  <script>
    const planet       = document.querySelector('.planet');
    const bg           = document.querySelector('.bg-layer');
    const walker       = document.querySelector('.walker');
    const orbitLayer   = document.querySelector('.orbit-layer');
    const dots         = document.querySelectorAll('.orbit-dot');
    const planetLabelEl= document.querySelector('.planet-label');

    const tooltip          = document.getElementById('planetTooltip');
    const tooltipTitleText = tooltip.querySelector('.tooltip-title-text');
    const tooltipDesc      = tooltip.querySelector('.tooltip-desc');
    const lockIcon         = tooltip.querySelector('.lock-icon');
    const lockedMsg        = tooltip.querySelector('.locked-msg');

    const introOverlay = document.querySelector('.intro-overlay');
    const introTextEl  = document.querySelector('.intro-text');

    /* ========================
       ê° í–‰ì„± â†’ í˜ì´ì§€ ë§¤í•‘
    ========================= */
    const planetRoutes = {
      'The Planet of Relation': 'index2.html',
      'The Planet of Work'    : 'index3.html',
      'The Planet of Emotion' : 'index4.html',
      'The Planet of Ego'     : 'index5.html',
      'The Planet of Art'     : 'index6.html',
      'The Planet of Faith'    : 'index7.html'
    };

    /* localStorage í‚¤ ë§¤í•‘ */
    const planetDoneKeys = {
      'The Planet of Relation': 'relationPlanetDone',
      'The Planet of Work'    : 'workPlanetDone',
      'The Planet of Emotion' : 'emotionPlanetDone',
      'The Planet of Ego'     : 'egoPlanetDone',
      'The Planet of Art'     : 'artPlanetDone',
      'The Planet of Faith'    : 'lifePlanetDone'
    };

    function isPlanetDone(title) {
      const key = planetDoneKeys[title];
      if (!key) return false;
      return localStorage.getItem(key) === 'true';
    }

    /* Life í–‰ì„± ì ê¸ˆ í•´ì œ ì¡°ê±´:
       Relation, Work, Emotion, Ego, Art ê°€ ëª¨ë‘ Done */
    function isLifeUnlocked() {
      const required = [
        'The Planet of Relation',
        'The Planet of Work',
        'The Planet of Emotion',
        'The Planet of Ego',
        'The Planet of Art'
      ];
      return required.every(t => isPlanetDone(t));
    }

    /* ============================
       ì¸íŠ¸ë¡œ í…ìŠ¤íŠ¸
    ============================= */
    const introLines = [
      "(scroll down)",
      "ì„¸ìƒì—ëŠ” ì €ë§ˆë‹¤ ì¥ê³  ìˆëŠ” ë¯¿ìŒì´ ìˆë‹¤ê³  í•´ìš”.",
      "â€˜ì‚¬ë‘ì€ ìµœê³ ì˜ ê°€ì¹˜ì•¼.', â€˜ê°ì •ì€ í†µì œí•´ì•¼í•´.â€™, â€˜ì˜ì›í•œ ê±´ ì—†ì–´.' ë“±.",
      "ìê¸° ë§ì„ ê°€ì¥ ì˜³ë‹¤ê³  ë¯¿ëŠ” ì‚¬ëŒë“¤ì€ ì„œë¡œì˜ ë§ì´ ë“¤ë¦¬ì§€ ì•ŠëŠ”ëŒ€ìš”.",
      "ì‚´ê¸° ìœ„í•´ ë§Œë“  ë¯¿ìŒë“¤ì€ ì´ ê³³ì—ì„œ ëª¨ì—¬ í–‰ì„±ì„ ì´ë£¨ê³ ,",
      "ì–´ë–¤ ì‚¬ëŒë“¤ì€ ê·¸ í–‰ì„± ì•ˆì— í‰ìƒ ê°‡íŒ ì±„ ì‚´ì•„ê°„ëŒ€ìš”.",
      "ëˆ„ê°€ ì˜³ì€ì§€ëŠ” ëª°ë¼ë„, í–‰ì„±ë“¤ ì‚¬ì´ë¥¼ íƒí—˜í•˜ë©° ë§ë“¤ì„ ëª¨ìœ¼ê³  ìˆì–´ìš”.",
      "ì œê°€ ë¯¿ê³  ì‚´ì•„ê°ˆ ê°€ì¹˜ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?"
    ];

    let introDone      = false;
    let introIndex     = 0;
    let introAnimating = false;

    function showIntroLine(index) {
      if (!introTextEl) return;
      introAnimating = true;
      introTextEl.style.opacity = 0;

      setTimeout(() => {
        introTextEl.textContent = introLines[index];
        introTextEl.style.opacity = 1;
        setTimeout(() => {
          introAnimating = false;
        }, 600);
      }, 150);
    }

    function finishIntro() {
      if (introDone) return;
      introDone = true;

      if (introOverlay) {
        introOverlay.style.opacity = 0;
        setTimeout(() => {
          introOverlay.style.display = 'none';
        }, 1000);
      }

      const titleEl = document.querySelector('.title');
      if (titleEl) titleEl.style.opacity = 1;

      const introTitleEl = document.querySelector('.intro-title');
      if (introTitleEl) introTitleEl.classList.add('hide');

      if (walker) walker.style.opacity = 1;
      if (orbitLayer) orbitLayer.style.opacity = 1;

      document.body.style.overflow = 'auto';
            restoreAnglesFromStorage();
      window.removeEventListener('wheel', handleIntroWheel);

      updateActivePlanetLabel();
      syncPlanetBadges();
    }

    function handleIntroWheel(e) {
      if (introDone) return;
      e.preventDefault();
      if (introAnimating) return;

      const threshold = 10;

      if (e.deltaY > threshold) {
        if (introIndex < introLines.length - 1) {
          introIndex++;
          showIntroLine(introIndex);
        } else {
          finishIntro();
        }
      } else if (e.deltaY < -threshold) {
        if (introIndex > 0) {
          introIndex--;
          showIntroLine(introIndex);
        }
      }
    }

    /* ============================
       ê±·ê¸° + íšŒì „ ìƒíƒœ
    ============================= */
    let planetAngle = 0;
    let orbitAngle  = 0;
    let bgAngle     = 0;

    const FRAME_WIDTH      = 800;
    const TOTAL_FRAMES     = 12;
    const IDLE_FRAME       = 0;
    let currentFrame       = IDLE_FRAME;
    let stopTimer          = null;

    let frameProgress      = 0;
    const FRAME_SPEED_FACTOR = 0.05;

    const CHAR_RATIO       = 0.25;
    const ON_SURFACE_OFFSET= 0.06;

    let walkerDirection    = 1;

    /* ============================
       ğŸŒ ê³ í–¥ í–‰ì„± ê°ë„ ì €ì¥/ë³µì›
    ============================= */
    function saveAnglesToStorage() {
      try {
        localStorage.setItem('homePlanetAngles', JSON.stringify({
          planetAngle,
          orbitAngle,
          bgAngle
        }));
      } catch (e) {
        // ë¬´ì‹œ
      }
    }

    function restoreAnglesFromStorage() {
      try {
        const raw = localStorage.getItem('homePlanetAngles');
        if (!raw) return;
        const data = JSON.parse(raw);

        if (typeof data.planetAngle === 'number') planetAngle = data.planetAngle;
        if (typeof data.orbitAngle  === 'number') orbitAngle  = data.orbitAngle;
        if (typeof data.bgAngle     === 'number') bgAngle     = data.bgAngle;

        if (planet) {
          planet.style.setProperty('--planet-angle', `${planetAngle}deg`);
        }
        if (orbitLayer) {
          orbitLayer.style.setProperty('--orbit-angle', `${orbitAngle}deg`);
        }
        if (bg) {
          bg.style.transform = `translate(-50%, -50%) rotate(${bgAngle}deg)`;
        }
      } catch (e) {
        // ë¬´ì‹œ
      }
    }

    function positionWalker() {
      if (!planet || !walker) return;
      const rect       = planet.getBoundingClientRect();
      const planetSize = rect.width;

      const charSize = planetSize * CHAR_RATIO;
      const scale    = charSize / FRAME_WIDTH;

      walker.style.transform = `translateX(-50%) scale(${walkerDirection * scale}, ${scale})`;

      const planetTop  = rect.top;
      const baseBottom = window.innerHeight - planetTop;
      const bottom     = baseBottom - planetSize * ON_SURFACE_OFFSET;

      walker.style.bottom = `${bottom}px`;
    }

    function setWalkerFrame(frameIndex) {
      if (!walker) return;
      const x = -FRAME_WIDTH * frameIndex;
      walker.style.backgroundPosition = `${x}px 0`;
    }

    setWalkerFrame(IDLE_FRAME);
    positionWalker();
    window.addEventListener('resize', () => {
      positionWalker();
      updateActivePlanetLabel();
      syncPlanetBadges();
    });

    function applyMotion(rawDelta) {
      if (!introDone) return;
      if (!rawDelta) return;

      const direction = rawDelta > 0 ? 1 : -1;
      const d         = Math.abs(rawDelta);

      walkerDirection = (direction > 0) ? 1 : -1;
      positionWalker();

      planetAngle += direction * d * 0.03;
      orbitAngle  += direction * d * 0.01;
      bgAngle     += direction * d * 0.003;

      if (planet) {
        planet.style.setProperty('--planet-angle', `${planetAngle}deg`);
      }
      if (orbitLayer) {
        orbitLayer.style.setProperty('--orbit-angle', `${orbitAngle}deg`);
      }
      if (bg) {
        bg.style.transform = `translate(-50%, -50%) rotate(${bgAngle}deg)`;
      }

      // ğŸ“Œ ê°ë„ ì €ì¥
      saveAnglesToStorage();

      let speed = d;

      if (speed < 0.8) speed = 0.8;
      if (speed > 8)   speed = 8;

      frameProgress += speed * FRAME_SPEED_FACTOR;

      while (frameProgress >= 1) {
        frameProgress -= 1;

        if (currentFrame === IDLE_FRAME) {
          currentFrame = 1;
        } else {
          currentFrame++;
          if (currentFrame >= TOTAL_FRAMES) currentFrame = 1;
        }
        setWalkerFrame(currentFrame);
      }

      if (stopTimer) clearTimeout(stopTimer);
      stopTimer = setTimeout(() => {
        currentFrame   = IDLE_FRAME;
        frameProgress  = 0;
        setWalkerFrame(currentFrame);
      }, 250);
    }

    function handleMainWheel(e) {
      if (!introDone) return;
      applyMotion(e.deltaY);
      updateActivePlanetLabel();
      syncPlanetBadges();
    }

    window.addEventListener('wheel', handleMainWheel, { passive: true });

    /* ============================
       í˜„ì¬ ìºë¦­í„° ì•„ë˜ í–‰ì„± ì œëª©
    ============================= */
    function updateActivePlanetLabel() {
      if (!planetLabelEl) return;

      if (!introDone) {
        planetLabelEl.classList.remove('visible');
        planetLabelEl.textContent = '';
        return;
      }

      const centerX = window.innerWidth / 2;
      let closestDot = null;
      let closestDx  = Infinity;

      dots.forEach(dot => {
        const rect       = dot.getBoundingClientRect();
        const dotCenterX = rect.left + rect.width / 2;
        const dx         = dotCenterX - centerX;

        if (Math.abs(dx) < closestDx) {
          closestDx  = Math.abs(dx);
          closestDot = dot;
        }
      });

      const THRESHOLD = 90;

      if (closestDot && closestDx < THRESHOLD) {
        const title = closestDot.getAttribute('data-title') || '';
        if (title) {
          planetLabelEl.textContent = title;
          planetLabelEl.classList.add('visible');
        } else {
          planetLabelEl.classList.remove('visible');
        }
      } else {
        planetLabelEl.classList.remove('visible');
      }
    }

    /* ============================
       â˜… íƒí—˜ì™„ë£Œ ë±ƒì§€ ìƒì„±/ìœ„ì¹˜ ê°±ì‹ 
    ============================= */
    const planetBadgeMap = new Map(); // dot â†’ { badge, connector }

    function ensureBadgeForDot(dot) {
      if (planetBadgeMap.has(dot)) return planetBadgeMap.get(dot);

      const badge = document.createElement('div');
      badge.className = 'planet-badge no-select';
      badge.innerHTML = `
        <div class="planet-badge-circle">âœ“</div>
        <div class="planet-badge-text">íƒí—˜ì™„ë£Œ</div>
      `;

      const connector = document.createElement('div');
      connector.className = 'planet-connector';
      connector.innerHTML = `
        <div class="planet-connector-line planet-connector-diag"></div>
        <div class="planet-connector-line planet-connector-horiz"></div>
      `;

      document.body.appendChild(badge);
      document.body.appendChild(connector);

      const pair = { badge, connector };
      planetBadgeMap.set(dot, pair);
      return pair;
    }

    function updateBadgePositionForDot(dot, pair) {
      const rect = dot.getBoundingClientRect();

      const starCenterX = rect.left + rect.width / 2;
      const starCenterY = rect.top + rect.height / 2;

      const offsetX = 40;
      const offsetY = -26;

      pair.badge.style.left = (starCenterX + offsetX) + 'px';
      pair.badge.style.top  = (starCenterY + offsetY) + 'px';

      pair.connector.style.left = starCenterX + 'px';
      pair.connector.style.top  = starCenterY + 'px';
    }

    function syncPlanetBadges() {
      if (!introDone) return;

      dots.forEach(dot => {
        const title = dot.getAttribute('data-title');
        if (!title) return;

        const done = isPlanetDone(title);
        let pair   = planetBadgeMap.get(dot);

        if (!done) {
          if (pair) {
            pair.badge.style.display     = 'none';
            pair.connector.style.display = 'none';
          }
          return;
        }

        pair = ensureBadgeForDot(dot);
        pair.badge.style.display     = 'flex';
        pair.connector.style.display = 'block';

        updateBadgePositionForDot(dot, pair);
      });
      updateTitleWhenAllDone();

    }

    /* ============================
       íˆ´íŒ
    ============================= */
    let hoveredDot   = null;
    let tooltipAnimId = null;

    function updateTooltipPosition() {
      if (!hoveredDot) return;

      const rect     = hoveredDot.getBoundingClientRect();
      const centerX  = rect.left + rect.width / 2;
      const centerY  = rect.top + rect.height / 2;

      const offsetX  = 80;
      const offsetY  = 0;

      tooltip.style.left = (centerX + offsetX) + 'px';
      tooltip.style.top  = (centerY + offsetY) + 'px';

      tooltipAnimId = requestAnimationFrame(updateTooltipPosition);
    }

    dots.forEach(dot => {
      const title = dot.getAttribute('data-title');
      const desc  = dot.getAttribute('data-desc');

      dot.addEventListener('mouseenter', () => {
        if (!title) return;

        hoveredDot = dot;
        tooltipTitleText.textContent = title;
        tooltipDesc.innerHTML = (desc || "").replace(/\n/g, "<br>");

        // Life í–‰ì„± ì ê¸ˆ ìƒíƒœì— ë”°ë¼ ìë¬¼ì‡ /ë©”ì‹œì§€ í‘œì‹œ
        if (title === 'The Planet of Faith' && !isLifeUnlocked()) {
          lockIcon.style.display = 'inline-block';
          lockedMsg.style.display = 'inline';
        } else {
          lockIcon.style.display = 'none';
          lockedMsg.style.display = 'none';
        }

        tooltip.style.opacity   = '1';
        tooltip.style.visibility = 'visible';

        if (tooltipAnimId) cancelAnimationFrame(tooltipAnimId);
        updateTooltipPosition();
      });

      dot.addEventListener('mouseleave', () => {
        hoveredDot = null;
        if (tooltipAnimId) {
          cancelAnimationFrame(tooltipAnimId);
          tooltipAnimId = null;
        }
        tooltip.style.opacity   = '0';
        tooltip.style.visibility = 'hidden';

        lockIcon.style.display  = 'none';
        lockedMsg.style.display = 'none';
      });

      dot.addEventListener('click', () => {
        if (!title) return;

        // Life í–‰ì„± ì ê²¨ ìˆìœ¼ë©´ ì´ë™ ë§‰ê¸°
        if (title === 'The Planet of Faith' && !isLifeUnlocked()) {
          // í•„ìš”í•˜ë©´ alert ëŒ€ì‹  ì¡°ìš©íˆ ë¬´ì‹œ
          alert('ë‹¤ë¥¸ 5ê°œì˜ í–‰ì„±ì„ ë¨¼ì € íƒí—˜í•´ì•¼ ì´ í–‰ì„±ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
          return;
        }

        const url = planetRoutes[title];
        if (url) {
                    saveAnglesToStorage();
  brownLoadAndGo(url);

        }
        console.log('Clicked:', title);
      });
    });

    /* ============================
       onload: ì¸íŠ¸ë¡œ + ìƒíƒœ ì´ˆê¸°í™”
    ============================= */
    window.addEventListener('load', () => {
      syncPlanetBadges();
      updateTitleWhenAllDone();

      const params   = new URLSearchParams(window.location.search);
      const skipIntro = params.get('skipIntro') === 'true';

      if (skipIntro) {
        introDone = true;

        const introOverlayEl = document.querySelector('.intro-overlay');
        const introTitleEl   = document.querySelector('.intro-title');
        const introTextEl2   = document.querySelector('.intro-text');
        const titleEl        = document.querySelector('.title');

        if (introOverlayEl) introOverlayEl.style.display = 'none';
        if (introTitleEl)   introTitleEl.style.display   = 'none';
        if (introTextEl2)   introTextEl2.style.display   = 'none';

        if (titleEl) titleEl.style.opacity = 1;
        if (walker)  walker.style.opacity  = 1;
        if (orbitLayer) orbitLayer.style.opacity = 1;

        document.body.style.overflow = 'auto';
              restoreAnglesFromStorage();
        updateActivePlanetLabel();
        syncPlanetBadges();
      } else {
        document.body.style.overflow = 'hidden';
        showIntroLine(introIndex);
        window.addEventListener('wheel', handleIntroWheel, { passive: false });
      }
    });
    function updateTitleWhenAllDone() {
  const titleEl = document.querySelector(".title");
  if (!titleEl) return;

  // Life í–‰ì„± ì ê¸ˆ í•´ì œë˜ë©´ (= 5ê°œ ì™„ë£Œë˜ë©´)
  if (isLifeUnlocked()) {
    titleEl.textContent = "5ê°œì˜ í–‰ì„± íƒì‚¬ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹ ë…ì˜ í–‰ì„±ì— ì§„ì…í•´ë³´ì„¸ìš”.";
  } else {
    titleEl.textContent = "íƒì‚¬í•  í–‰ì„±ì„ ì„ íƒí•˜ì„¸ìš”";
  }
}

    /* ===========================
   ğŸŒ™ ë¡œë”© í™”ë©´ ìë™ ì œê±°
=========================== */
window.addEventListener("load", () => {
  const loader = document.getElementById("loading-screen");

  // 0.2ì´ˆ ê¸°ë‹¤ë ¸ë‹¤ê°€ (ë„ˆë¬´ ë²ˆì© ì‚¬ë¼ì§€ëŠ” ê²ƒ ë°©ì§€)
  setTimeout(() => {
    loader.style.opacity = 0;

    // í™”ë©´ì—ì„œ ì™„ì „íˆ ì œê±°
    setTimeout(() => {
      loader.style.display = "none";
    }, 1000); // transition 1sì™€ ë™ì¼
  }, 300);
});
function brownLoadAndGo(url) {
  const loader = document.getElementById("loading-screen");
  if (!loader) {
    window.location.href = url;
    return;
  }

  // ê°ˆìƒ‰ ë¡œë”©ì„ ë‹¤ì‹œ ë³´ì—¬ì£¼ê¸°
  loader.style.display = "flex";
  loader.style.opacity = "1";

  // ì•½ê°„ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì´ë™ (ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ë³´ì´ë„ë¡)
  setTimeout(() => {
    window.location.href = url;
  }, 500);
}
const bgm = document.getElementById('bgm');
bgm.volume = 0.35;

function startBGM() {
  if (!bgm) return;

  bgm.play().then(() => {
    window.removeEventListener('pointerdown', startBGM);
    window.removeEventListener('keydown', startBGM);
    window.removeEventListener('touchstart', startBGM);
    window.removeEventListener('wheel', startBGM);
  }).catch((e) => {
    console.log('BGM blocked:', e);
  });
}

window.addEventListener('pointerdown', startBGM, { once: true });
window.addEventListener('keydown', startBGM, { once: true });
window.addEventListener('touchstart', startBGM, { once: true });
window.addEventListener('wheel', startBGM, { once: true });

  </script>
  <div id="loading-screen">
  <div class="loading-circle"></div>
  <div class="loading-text">Loading...</div>
</div>
  <audio id="bgm" src="Star.mp3" preload="auto" loop></audio>

</body>
</html>
